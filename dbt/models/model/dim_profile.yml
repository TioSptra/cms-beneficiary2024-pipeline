version: 2

models:
  - name: dim_profile
    description: >
      Menyimpan informasi demografi dan status kelayakan Medicare peserta (profil penerima).
    columns:
      - name: bene_id
        description: ID unik penerima manfaat.
        tests:
          - not_null
          - unique

      - name: gender
        description: Jenis kelamin peserta (Male/Female).
        tests:
          - accepted_values:
              values: ['Male', 'Female']

      - name: birth_date
        description: Tanggal lahir peserta.
        tests:
          - not_null

      - name: death_date
        description: Tanggal kematian (jika ada).
        tests:
          - not_null

      - name: age_at_end_of_year
        description: Umur peserta pada akhir tahun referensi.
        tests:
        - not_null

      - name: race_final
        description: Kode ras RTI peserta.
        tests:
          - not_null

      - name: race_desc
        description: Deskripsi ras peserta.
        tests: 
          - accepted_values:
              values: ['White','Black','Other','Asian','Hispanic','American Indian or Alaska Native']

      - name: current_bic_code
        description: Kode pembayaran tunjangan saat ini.
        tests:
          - accepted_values:
              values: ['A', 'B', 'B1', 'B2', 'B3', 'B6', 'B9', 'BR', 'BT', 'BY', 'C1', 'C2', 'C3', 'D', 'D1', 'D2', 'D3', 'D6', 'M', 'T', 'TA']

      - name: valid_death_date_flag
        description: Indikator validitas tanggal kematian.
        tests:
          - accepted_values:
              values: ['Y', 'N']